---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 


```{r}
create_TC = function(interval, one_time, start_time){
  
  # Create initial matrix
  TC = matrix(0, 240, 1)
  
  # Counts for how many ones have been added / not added
  on_count = 1
  off_count = 0
  
  for(i in 1:240){
    
    # Check if the current time in source is before our start time
    if (i <= start_time) {
      next
    }
    
    # Change value in matrix if it is within the time period to do so 
    # Otherwise increment the time that one has not been added
    # Reset if at the end of a interval
    if(on_count <= one_time) {
      TC[i] = 1
      on_count = on_count + 1
    } else{
      off_count = off_count + 1
      if (off_count == interval - one_time) {
        on_count = 1
        off_count = 0
      }
  
    }
  
  }
  return(TC)
}
```


```{r}
TC1 = create_TC(30, 15, 0)
TC2 = create_TC(45, 20, 20)
TC3 = create_TC(60, 25, 0)
TC4 = create_TC(40, 15, 0)
TC5 = create_TC(40, 20, 0)
TC6 = create_TC(40, 25, 0)

```

```{r}
standardise_TC = function(TC) {
  TC_mean = mean(TC)
  TC_var = var(TC)
  TC1 = TC - TC_mean
  TC2 = TC1 / sqrt(TC_var[1])
  return(TC2)
}
```





Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
standard_TC1 = standardise_TC(TC1)
standard_TC2 = standardise_TC(TC2)
standard_TC3 = standardise_TC(TC3)
standard_TC4 = standardise_TC(TC4)
standard_TC5 = standardise_TC(TC5)
standard_TC6 = standardise_TC(TC6)
```


```{r}
plot(standard_TC1, ylab = "Temporal source 1")
plot(standard_TC2, ylab = "Temporal source 2")
plot(standard_TC3, ylab = "Temporal source 3")
plot(standard_TC4, ylab = "Temporal source 4")
plot(standard_TC5, ylab = "Temporal source 5")
plot(standard_TC6, ylab = "Temporal source 6")
```
```{r}
full_TC = matrix(c(standard_TC1, standard_TC2, standard_TC3, standard_TC4, standard_TC5, standard_TC6), 240, 6)
correlation = cor(full_TC)
install.packages("corrplot")
library(corrplot)
corrplot(correlation, tl.srt = 0)
help(corrplot)
```

