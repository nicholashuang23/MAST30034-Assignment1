---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 
```{r}
#install.packages("corrplot")
library(corrplot)
install.packages("Rfast")
library(Rfast)
```


```{r}
# 1a
create_TC = function(interval, one_time, start_time){
  
  # Create initial matrix
  TC = matrix(0, 240, 1)
  
  # Counts for how many ones have been added / not added
  on_count = 1
  off_count = 0
  
  for(i in 1:240){
    
    # Check if the current time in source is before our start time
    if (i <= start_time) {
      next
    }
    
    # Change value in matrix if it is within the time period to do so 
    # Otherwise increment the time that one has not been added
    # Reset if at the end of a interval
    if(on_count <= one_time) {
      TC[i] = 1
      on_count = on_count + 1
    } else{
      off_count = off_count + 1
      if (off_count == interval - one_time) {
        on_count = 1
        off_count = 0
      }
  
    }
  
  }
  return(TC)
}
```


```{r}
# 1a
TC1 = create_TC(30, 15, 0)
TC2 = create_TC(45, 20, 20)
TC3 = create_TC(60, 25, 0)
TC4 = create_TC(40, 15, 0)
TC5 = create_TC(40, 20, 0)
TC6 = create_TC(40, 25, 0)

```

```{r}
# 1a
standardise_TC = function(TC) {
  TC_mean = mean(TC)
  TC_var = var(TC)
  TC1 = TC - TC_mean
  TC2 = TC1 / sqrt(TC_var[1])
  return(TC2)
}
```





Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
# 1a
standard_TC1 = standardise_TC(TC1)
standard_TC2 = standardise_TC(TC2)
standard_TC3 = standardise_TC(TC3)
standard_TC4 = standardise_TC(TC4)
standard_TC5 = standardise_TC(TC5)
standard_TC6 = standardise_TC(TC6)
```


```{r}
# 1a
plot(standard_TC1, ylab = "Temporal source 1", pch = 1, type = "line")
plot(standard_TC2, ylab = "Temporal source 2", pch = 1, type = "line")
plot(standard_TC3, ylab = "Temporal source 3", pch = 1, type = "line")
plot(standard_TC4, ylab = "Temporal source 4", pch = 1, type = "line")
plot(standard_TC5, ylab = "Temporal source 5", pch = 1, type = "line")
plot(standard_TC6, ylab = "Temporal source 6", pch = 1, type = "line")


```

```{r}
# 1b
full_TC = matrix(c(standard_TC1, standard_TC2, standard_TC3, standard_TC4, standard_TC5, standard_TC6), 240, 6)
correlation = cor(full_TC)
corrplot(correlation, tl.srt = 0)
#help(corrplot)
```
```{r}
help("heatmap")
correlation
```

```{r}
# 1c
create_tmpSM = function(vert_start,vert_end, horo_start, horo_end) {
  tmpSM = matrix(0, 21, 21)
  tmpSM[vert_start:vert_end, horo_start:horo_end] = 1
  return(tmpSM)
}
```


```{r}
# 1c
tmpSM1 = create_tmpSM(2, 6, 2, 6)
tmpSM2 = create_tmpSM(2, 6, 15, 19)
tmpSM3 = create_tmpSM(8, 13, 2, 6)
tmpSM4 = create_tmpSM(8, 13, 15, 19)
tmpSM5 = create_tmpSM(15, 19, 2, 6)
tmpSM6 = create_tmpSM(15, 19, 15, 19)
```


```{r}
library(ggplot2)
# 1c
#ggplot(tmpSM1) + geom_tile()
#heatmap(tmpSM1, Colv = NA, Rowv = NA, scale="column")
#plot(tmpSM2)
#plot(tmpSM3)
#plot(tmpSM4)
#plot(tmpSM5)
#plot(tmpSM6)
```


```{r}
# 1c
tmpSM1 = matrix(tmpSM1, 1, 441)
tmpSM1 = matrix(tmpSM2, 1, 441)
tmpSM1 = matrix(tmpSM3, 1, 441)
tmpSM1 = matrix(tmpSM4, 1, 441)
tmpSM1 = matrix(tmpSM5, 1, 441)
tmpSM1 = matrix(tmpSM6, 1, 441)
tmpSM = matrix(c(tmpSM1, tmpSM2, tmpSM3, tmpSM4, tmpSM5, tmpSM6), 441, 6)
tmpSM = t(tmpSM)

correlation2 = cor(t(tmpSM))
corrplot(correlation2, tl.srt = 0)
correlation2
```


```{r}
#1d
noise_t = rnorm(6 * 240, mean = 0, sd = 0.25)
noise_s = rnorm(6 * 441, mean = 0, sd = 0.15)

noise_s = matrix(noise_t, 6, 441)
noise_t = matrix(noise_s, 240, 6)

correlation3 = cor(noise_t)
corrplot(correlation3, tl.srt = 0)


correlation4 = cor(t(noise_s))
corrplot(correlation4, tl.srt = 0)


hist(noise_s)
hist(noise_t)

correlation5 = cor(noise_t %*% noise_s)
corrplot(correlation5, tl.srt = 0)

```


```{r}
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid(X=x, Y=y)
data$Z <- runif(400, 0, 5)

x
y
data

ggplot(data, aes(X, Y, fill= Z)) + 
  geom_tile()

t
```
```{r}
X = (full_TC + noise_t) %*% (tmpSM + noise_s)
set.seed(1)
mysample <- sample(length(X), 100)
mysample

X[mysample]
dogy = colVars(X)
plot(dogy)
scaled_X = scale(X)
```


